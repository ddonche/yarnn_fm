!function(ba){ba.fn.hap=function(d){function t(t){var e,a,i,n;e=document,a="script",i="facebook-jssdk",n=e.getElementsByTagName(a)[0],e.getElementById(i)||((e=e.createElement(a)).id=i,e.src="//connect.facebook.net/en_US/sdk.js",n.parentNode.insertBefore(e,n)),window.fbAsyncInit=function(){FB.init({appId:t,xfbml:!0,version:"v2.9"})}}function e(t){if(pt){if(!Ve){if("touchstart"==t.type){if(!((t=t.originalEvent.touches)&&0<t.length))return!1}else t.preventDefault();Ve=!0,Xt.on(Ke,function(t){t:{if("touchmove"==t.type){if(t.originalEvent.touches&&t.originalEvent.touches.length)var e=t.originalEvent.touches;else{if(!t.originalEvent.changedTouches||!t.originalEvent.changedTouches.length)break t;e=t.originalEvent.changedTouches}if(1<e.length)break t;e=e[0]}else e=t;t.preventDefault(),a(e)}}).on(Qe,function(t){t:if(Ve){if(Ve=!1,Xt.off(Ke).off(Qe),"touchend"==t.type){if(t.originalEvent.touches&&t.originalEvent.touches.length)var e=t.originalEvent.touches;else{if(!t.originalEvent.changedTouches||!t.originalEvent.changedTouches.length)break t;e=t.originalEvent.changedTouches}if(1<e.length)break t;e=e[0]}else e=t;t.preventDefault(),a(e)}})}return!1}}function a(t){if(Ye?t=ze.setProgress(t):((t=t.pageX-Ze.offset().left)<0?t=0:Je<t&&(t=Je),t=Math.max(0,Math.min(1,t/Je))),Jt&&we)try{Jt.currentTime=t*Jt.duration}catch(e){console.log(e)}}function i(t){if(Ye)e=ze.trackTooltip(t),a=z[0].getBoundingClientRect(),i=aa[0].getBoundingClientRect(),t=parseInt(i.top-a.top-Xe.outerHeight()-10),n=parseInt(i.left-a.left-Xe.outerWidth()/2+aa.outerWidth()/2);else{if(e=t.pageX-Ze.offset().left,!HAPUtils.isNumber(e))return!1;e<0?e=0:Je<e&&(e=Je);var e=Math.max(0,Math.min(1,e/Je)),a=z[0].getBoundingClientRect(),i=aa[0].getBoundingClientRect(),n=parseInt(t.pageX-$t.scrollLeft()-a.left-Xe.outerWidth()/2);t=parseInt(i.top-a.top-5-Xe.outerHeight(),10)}if(n+Xe.outerWidth()>z.width()?n=z.width()-Xe.outerWidth():n<0&&(n=0),t+a.top<0&&(t=parseInt(i.top-a.top+Xe.outerHeight()+15)),Xe.css({left:n+"px",top:t+"px"}).show(),!HAPUtils.isNumber(e))return!1;Jt&&(t=e*(a=Jt.duration),HAPUtils.isNumber(t)&&HAPUtils.isNumber(a)&&Xe.find("p").html(HAPUtils.formatCurrentTime(t)+" / "+HAPUtils.formatDuration(a)))}function n(t){if(pt){if(!na){if("touchstart"==t.type){if(!((t=t.originalEvent.touches)&&0<t.length))return!1}else t.preventDefault();na=!0,Xt.on(Ke,function(t){t:{if("touchmove"==t.type){if(t.originalEvent.touches&&t.originalEvent.touches.length)var e=t.originalEvent.touches;else{if(!t.originalEvent.changedTouches||!t.originalEvent.changedTouches.length)break t;e=t.originalEvent.changedTouches}if(1<e.length)break t;e=e[0]}else e=t;t.preventDefault(),r(e)}}).on(Qe,function(t){t:if(na){if(na=!1,Xt.off(Ke).off(Qe),"touchend"==t.type){if(t.originalEvent.touches&&t.originalEvent.touches.length)var e=t.originalEvent.touches;else{if(!t.originalEvent.changedTouches||!t.originalEvent.changedTouches.length)break t;e=t.originalEvent.changedTouches}if(1<e.length)break t;e=e[0]}else e=t;t.preventDefault(),r(e)}})}return!1}}function u(){if(!pt)return!1;0<Mt?(ra=Mt,Mt=0):Mt=ra,o()}function r(t){ua?Mt=1-(Mt=Math.max(0,Math.min(1,(t.pageY-sa.offset().top)/pa))):Mt=Math.max(0,Math.min(1,(t.pageX-sa.offset().left)/pa)),o()}function o(t){void 0!==t&&(Mt=t),Jt&&(Jt.volume=Mt),t=ua?"height":"width",HAPUtils.isNumber(pa)||(pa=volumeVertical?sa.height():sa.width()),da.css(t,Mt*pa+"px"),0==Mt?oa.find("i").removeClass("fa-volume-up fa-volume-down").addClass("fa-volume-off"):0<Mt&&Mt<.5?oa.find("i").removeClass("fa-volume-off fa-volume-up").addClass("fa-volume-down"):oa.find("i").removeClass("fa-volume-off fa-volume-down").addClass("fa-volume-up"),ba(Bt).trigger("volumeChange",{instance:Bt,instanceName:vt,volume:Mt})}function l(t){var e=ua?t.pageY-sa.offset().top:t.pageX-sa.offset().left;if(e<0?e=0:pa<e&&(e=pa),e=Math.max(0,Math.min(1,e/pa)),!HAPUtils.isNumber(e))return!1;ua&&(e=1-e),e=parseInt(100*e,10),Xe.find("p").text(e+" %"),e=z[0].getBoundingClientRect();var a=la[0].getBoundingClientRect();if(ua){var i=parseInt(a.left-e.left-Xe.outerWidth()/2+la.outerWidth()/2);t=parseInt(t.pageY-$t.scrollTop()-e.top-Xe.outerHeight()-10)}else i=parseInt(t.pageX-$t.scrollLeft()-e.left-Xe.outerWidth()/2),t=parseInt(a.top-e.top-Xe.outerHeight());i+Xe.outerWidth()>z.width()?i=z.width()-Xe.outerWidth():i<0&&(i=0),t+e.top<0&&(t=parseInt(a.top-e.top+Xe.outerHeight()+15)),Xe.css({left:i+"px",top:t+"px"}).show()}function p(t){return t.preventDefault(),!!pt&&(t=ba(t.currentTarget),(!be||!be.is(t))&&(pe=!0,$e.processPlaylistRequest(t.closest(".hap-playlist-item").index()),void ba(Bt).trigger("clickPlaylistItem",{instance:Bt,instanceName:vt})))}function c(t){return t.preventDefault(),!!pt&&(t=ba(t.currentTarget),(!be||!be.is(t))&&(t.removeClass("hap-playlist-non-selected").addClass("hap-playlist-selected"),void ba(Bt).trigger("overPlaylistItem",{instance:Bt,instanceName:vt,item:t})))}function h(t){return t.preventDefault(),!!pt&&(t=ba(t.currentTarget),(!be||!be.is(t))&&(t.removeClass("hap-playlist-selected").addClass("hap-playlist-non-selected"),void ba(Bt).trigger("outPlaylistItem",{instance:Bt,instanceName:vt,item:t})))}function s(t){if(!pt)return!1;if((t=ba(t.currentTarget)).hasClass("hap-prev-toggle"))Bt.previousMedia();else if(t.hasClass("hap-playback-toggle"))Bt.togglePlayback();else if(t.hasClass("hap-next-toggle"))Bt.nextMedia();else if(t.hasClass("hap-volume-toggle"))u();else if(t.hasClass("hap-loop-toggle"))Pt=!Pt,$e.setLooping(Pt),Pt?dt.find("i").removeClass("hap-icon-color").addClass("hap-icon-rollover-color"):dt.find("i").removeClass("hap-icon-rollover-color").addClass("hap-icon-color");else if(t.hasClass("hap-random-toggle"))Ct=!Ct,$e.setRandom(Ct),Ct?ut.find("i").removeClass("hap-icon-color").addClass("hap-icon-rollover-color"):ut.find("i").removeClass("hap-icon-rollover-color").addClass("hap-icon-color");else if(t.hasClass("hap-sort-alpha"))Bt.sort("title",Te);else if(t.hasClass("hap-popup-toggle"))hapOpenPopup(Bt,d);else if(t.hasClass("hap-share-toggle"))Z.toggle();else if(t.hasClass("hap-share-item")){t=t.attr("data-type").toLowerCase();var e,a="https:"==window.location.protocol?"https:":"http:",i=(window.screen.width-600)/2,n=(window.screen.height-300)/2,r=Ae.title||"",o=Ae.description||"",l=Ae.thumb||"",s=Ae.share||window.location.href;HAPUtils.relativePath(l)||(l=HAPUtils.qualifyURL(l)),"facebook"==t?window.FB&&FB.ui({method:"share_open_graph",action_type:"og.shares",action_properties:JSON.stringify({object:{"og:url":s,"og:title":r,"og:description":o,"og:image":l}})}):"twitter"==t?e=a+"//twitter.com/share?url="+encodeURIComponent(s)+"&text="+encodeURIComponent(r):"googleplus"==t?e=a+"//plus.google.com/share?url="+encodeURIComponent(s):"tumblr"==t&&(e=a+"//www.tumblr.com/share/link?url="+encodeURIComponent(s)+"&amp;name="+encodeURIComponent(r)+"&amp;description="+encodeURIComponent(o)),e&&window.open(e,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,width=600,height=300,left="+i+",top="+n)}}function f(t){if(!pt||na||Ve)return!1;(t=ba(t.currentTarget).find("i")).hasClass("hap-icon-color")&&t.removeClass("hap-icon-color").addClass("hap-icon-rollover-color")}function m(t){if(!pt)return!1;var e=(t=ba(t.currentTarget)).find("i");t.hasClass("hap-random-toggle")&&Ct||t.hasClass("hap-loop-toggle")&&Pt||e.hasClass("hap-icon-rollover-color")&&e.removeClass("hap-icon-rollover-color").addClass("hap-icon-color")}function g(){be&&(ba(Bt).trigger("playlistItemEnabled",{instance:Bt,instanceName:vt,item:be}),be.removeClass("hap-playlist-selected").addClass("hap-playlist-non-selected"),be=null)}function v(t){ct=!0,et.show(),ye?W():V.empty();var e,a,i,n=ba(t);if(0==n.length)return alert("Failed playlist selection! Playlist - "+t+" does not exist. Check activePlaylist option in settings!"),N(),!1;(yt=t,ba(Bt).trigger("playlistStartLoad",{instance:Bt,instanceName:vt}),null!=n.attr("data-type")&&"xml"==n.attr("data-type"))?k(b(n)):(n.children(".hap-playlist-item").each(function(){a=ba(this),i=a.attr("data-type"),RegExp(/^audio$/).test(i)?qe.push(a.clone()):RegExp(/^hls$/).test(i)?qe.push(a.clone()):RegExp(/^radio$/).test(i)?qe.push(a.clone()):(e=b(a),qe.push(e))}),je=qe.length,y())}function y(){if(je-1<++De)M();else{var t=qe[De],e=t.type;e?RegExp(/^soundcloud$/).test(e)?(te=t.limit||1e3,Se=[],Zt?H(!0,t.path):T(t.path)):RegExp(/^podcast$/).test(e)?A(t):RegExp(/^itunes_podcast_music$/).test(e)?E(t):RegExp(/^folder$/).test(e)?w(t):/^gdrive-folder$/.test(e)?P(t):RegExp(/^audio$/).test(e)?(Oe.push(t),y()):RegExp(/^hls$/).test(e)&&(Oe.push(t),y()):(Oe.push(t),y())}}function b(t){var e={};if(e.origclasses=t.attr("class"),e.type=t.attr("data-type"),t.attr("data-hls")&&!HAPUtils.isEmpty(t.attr("data-hls"))&&(e.hls=t.attr("data-hls")),t.attr("data-mp3")&&!HAPUtils.isEmpty(t.attr("data-mp3"))&&(e.mp3=t.attr("data-mp3")),t.attr("data-wav")&&!HAPUtils.isEmpty(t.attr("data-wav"))&&(e.wav=t.attr("data-wav")),"audio"==e.type){if(null!=t.attr("data-path")&&!HAPUtils.isEmpty(t.attr("data-path"))){var a=t.attr("data-path"),i=a.substr(a.lastIndexOf(".")+1);"mp3"==i.toLowerCase()||"wav"==i.toLowerCase()?e[i.toLowerCase()]=a:e.mp3=a}}else null==t.attr("data-path")||HAPUtils.isEmpty(t.attr("data-path"))||(e.path=e.id=t.attr("data-path"));return null!=t.attr("data-limit")&&!HAPUtils.isEmpty(t.attr("data-limit"))&&HAPUtils.isNumber(t.attr("data-limit"))&&0!=Math.abs(parseInt(t.attr("data-limit"),10))&&(e.limit=Math.abs(parseInt(t.attr("data-limit"),10))),null==t.attr("data-artwork")||HAPUtils.isEmpty(t.attr("data-artwork"))||(e.artwork=t.data("artwork")),null==t.attr("data-thumb")||HAPUtils.isEmpty(t.attr("data-thumb"))?t.find(".hap-playlist-thumb img").length?e.thumb=t.find(".hap-playlist-thumb img").attr("src"):null==t.attr("data-thumb-default")||HAPUtils.isEmpty(t.attr("data-thumb-default"))||(e.thumbDefault=t.attr("data-thumb-default")):e.thumb=t.attr("data-thumb"),null==t.attr("data-thumb-quality")||HAPUtils.isEmpty(t.attr("data-thumb-quality"))||(e.thumbQuality=t.attr("data-thumb-quality")),null==t.attr("data-title")||HAPUtils.isEmpty(t.attr("data-title"))?t.find(".hap-playlist-title").length&&(e.title=t.find(".hap-playlist-title").html()):e.title=t.attr("data-title"),null==t.attr("data-description")||HAPUtils.isEmpty(t.attr("data-description"))||(e.description=t.attr("data-description")),null==t.attr("data-artist")||HAPUtils.isEmpty(t.attr("data-artist"))||(e.artist=t.attr("data-artist")),null==t.attr("data-album")||HAPUtils.isEmpty(t.attr("data-album"))||(e.album=t.attr("data-album")),null==t.attr("data-download")||HAPUtils.isEmpty(t.attr("data-download"))||(e.download=t.attr("data-download")),null!=t.attr("data-id3")&&(e.id3=!0),null==t.attr("data-start")||HAPUtils.isEmpty(t.attr("data-start"))||(e.start=Math.abs(t.attr("data-start"))),null==t.attr("data-end")||HAPUtils.isEmpty(t.attr("data-end"))||(e.end=Math.abs(t.attr("data-end"))),null!=t.attr("data-playback-rate")&&(e.playbackRate=1,HAPUtils.isEmpty(t.attr("data-playback-rate"))||(e.playbackRate=Math.abs(t.attr("data-playback-rate")))),null==t.attr("data-link")||HAPUtils.isEmpty(t.attr("data-link"))||(e.link=t.attr("data-link"),e.target="_blank",null==t.attr("data-target")||HAPUtils.isEmpty(t.attr("data-target"))||(e.target=t.attr("data-target"))),null==t.attr("data-share")||HAPUtils.isEmpty(t.attr("data-share"))||(e.share=t.attr("data-share")),t.is(":empty")||(e.content=t.html()),e}function w(o){if("file:"==window.location.protocol)return alert("Reading files from folders locally is not possible! This requires online server connection."),y(),!1;var t=o.path.replace(/\/\//g,"/"),e=gt+"includes/folder_parser.php";t={dir:t},o.id3&&(Kt=Gt=Oe.length-1),ba.ajax({type:"GET",url:e,data:t,dataType:"json"}).done(function(t){var e,a=t.length;for(HAPUtils.keysrt(t,"filename"),e=0;e<a;e++){var i=t[e],n=ba.extend(!0,{},o);n.type="audio";var r=i.fullpath;n[i.extension]=r,delete n.path,"undefined"==typeof n.download&&(n.download=r),"undefined"==typeof n.share&&(n.share=r),n.title||(n.title=i.filename),Oe.push(n),Gt++}o.id3?C():y()}).fail(function(t,e,a){console.log("Error processFolder: "+t,e,a),y()})}function P(o){return"file:"==window.location.protocol?(alert("Reading files from folders locally is not possible! This requires online server connection."),y(),!1):HAPUtils.isEmpty(xt)?(alert("gDriveAppId has not been set in settings!"),y(),!1):void ba.ajax({url:"https://www.googleapis.com/drive/v3/files?q='"+o.path+"'+in+parents&key="+xt,dataType:"jsonp"}).done(function(t){var e,a=t.files.length,i=[],n=[];for(e=0;e<a;e++){var r=t.files[e];/mp3|mpeg|mpeg3|wav/.test(r.mimeType)?n.push(r):/jpg|jpeg|png/.test(r.mimeType)&&i.push(r)}for(HAPUtils.keysrt(n,"name"),HAPUtils.keysrt(i,"name"),a=n.length,e=0;e<a;e++){r=n[e],(t=ba.extend(!0,{},o)).type="audio",t[r.name.substr(r.name.lastIndexOf(".")+1).toLowerCase()]="https://drive.google.com/uc?export=view&id="+r.id,delete t.path,"undefined"==typeof t.download&&(t.download="https://drive.google.com/uc?export=download&id="+r.id),"undefined"==typeof t.share&&(t.share="https://drive.google.com/open?id="+r.id),!t.thumb&&i[e]&&(t.thumb="https://drive.google.com/uc?export=view&id="+i[e].id),t.title||(t.title=r.name.substr(0,r.name.lastIndexOf("."))),Oe.push(t)}y()}).fail(function(t,e,a){console.log("Error processGdriveFolder: "+t,e,a),y()})}function C(){var n=Oe[Gt];jsmediatags.read(n.mp3||n.wav,{onSuccess:function(t){var e=t.tags;if(t=e.picture,e.artist&&(n.artist=e.artist),e.title&&(n.title=e.title),e.album&&(n.album=e.album),t){e="";var a,i=t.data.length;for(a=0;a<i;a++)e+=String.fromCharCode(t.data[a]);n.thumb="data:"+t.format+";base64,"+window.btoa(e)}Kt<--Gt?C():y()},onError:function(t){console.log("ID3 error: ",t.type,t.info),Kt<--Gt?C():y()}})}function k(t){ba.ajax({type:"GET",url:t.path,dataType:"html"}).done(function(t){var e,a,i;ba(t).children(".hap-playlist-item").each(function(){e=ba(this),a=e.attr("data-type"),RegExp(/^audio/).test(a)?qe.push(e):RegExp(/^hls/).test(a)?qe.push(e):(i=b(e),qe.push(i))}),je=qe.length,y()}).fail(function(t,e,a){console.log("Error processXml: "+t,e,a),y()})}function A(l){if("file:"==window.location.protocol)alert("Using Podcast locally is not possible! This requires online server connection!"),y();else{var t=Me+"?url="+encodeURIComponent(l.path);ba.ajax({url:t,dataType:"json",cache:!1}).done(function(t){var e,a,i,n=HAPUtils.parseXML(t.contents),r=0,o=l.limit||1e3;ba(n).find("image").length&&ba(n).find("image").attr("href")?i=ba(n).find("image").attr("href"):ba(t.contents).find("itunes\\:image").length&&ba(t.contents).find("itunes\\:image").attr("href")&&(i=ba(t.contents).find("itunes\\:image").attr("href")),ba(n).find("item").each(function(){if(o<=r)return!1;e=ba(this),(a=ba.extend(!0,{},l)).type="audio",a.path=e.find("enclosure").attr("url"),"undefined"==typeof a.download&&(a.download=a.path),!a.title&&e.find("title").length&&(a.title=e.find("title").text()),!a.artist&&e.find("author").length&&(a.artist=e.find("author").text()),!a.description&&e.find("description").length&&(a.description=e.find("description").text()),!a.duration&&e.find("duration").length&&(a.duration=e.find("duration").text()),a.thumb||(e.find("image").length&&e.find("image").attr("href")?a.thumb=e.find("image").attr("href"):i&&(a.thumb=i)),"undefined"==typeof a.share&&e.find("link").length&&(a.share=e.find("link").text()),Oe.push(a),r++}),y()}).fail(function(t,e,a){console.log("Error processPodcast: "+t,e,a),y()})}}function E(l){"file:"==window.location.protocol?(alert("Using Podcast locally is not possible! This requires online server connection!"),y()):(encodeURIComponent(l.path),ba.ajax({url:l.path}).done(function(t){t=ba("<div></div>").html(t);var e,a,i,n=0,r=l.limit||500;if(t.find(".lockup.product.podcast").length){var o=t.find(".lockup.product.podcast").find("img");o.length&&(o.attr("src-swap-high-dpi").length?i=o.attr("src-swap-high-dpi"):o.attr("src-swap").length&&(i=o.attr("src-swap")))}t.find("tr.podcast-episode").each(function(){if(r<=n)return!1;e=ba(this),(a=ba.extend(!0,{},l)).type="audio",a.path=e.attr("audio-preview-url"),!a.title&&e.attr("preview-title").length&&(a.title=e.attr("preview-title")),!a.artist&&e.attr("preview-artist").length&&(a.artist=e.attr("preview-artist")),!a.description&&e.find(".episode-info").length&&(a.description=e.find(".episode-info").next().text()),!a.thumb&&i&&(a.thumb=i),"undefined"==typeof a.share&&(a.share=l.path),Oe.push(a),n++}),y()}).fail(function(t,e,a){console.log("Error processPodcast: "+t,e,a),y()}))}function T(t){if("file:"==window.location.protocol)alert("Using SoundCloud locally is not possible! This requires online server connection!"),y();else{if(HAPUtils.isEmpty(It))return alert("soundCloudAppId has not been set! Skipping Soundcloud url: "+t),y(),!1;var e=document.createElement("script");e.src="https://connect.soundcloud.com/sdk.js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(e,a);var i=setInterval(function(){window.SC&&(i&&clearInterval(i),SC.initialize({client_id:It}),H(Zt=!0,t))},100)}}function H(t,r){SC.get(t?"https://api.soundcloud.com/resolve.json?url="+r+"&client_id="+It:r,{limit:200,linked_partitioning:1},function(t,e){if(console.log(t),e){for(console.log("Error getSoundCloudPage: "+e);Se.length;)Oe.push(Se.splice(0,1)[0]);y()}else{if("track"==t.kind)I(t);else if("playlist"==t.kind){var a,i=t.tracks.length;if(Se.length+i>=te){i=te-Se.length;var n=!0}for(a=0;a<i;a++)I(t.tracks[a])}else if(t.collection)for(i=t.collection.length,Se.length+i>=te&&(i=te-Se.length,n=!0),a=0;a<i;a++)I(t.collection[a]);else{if(t.username)return a=t.uri,void H(!1,a=/likes/.test(r)?a+"/likes":/favorites/.test(r)?a+"/favorites":a+"/tracks");if(ba.isArray(t))for(i=t.length,Se.length+i>=te&&(i=te-Se.length,n=!0),a=0;a<i;a++)I(t[a])}if(t.next_href&&!n)H(!1,t.next_href);else{for(;Se.length;)Oe.push(Se.splice(0,1)[0]);y()}}})}function I(t){if(t.streamable&&t.stream_url){var e=ba.extend(!0,{},qe[De]);e.type="audio",t.duration&&(e.duration=t.duration),e.path=t.stream_url+"?client_id="+It,"undefined"==typeof e.download&&(t.downloadable&&t.download_url?e.download=e.path.replace(/\/stream\\?/,"/download"):delete e.download),!e.title&&t.title&&(e.title=t.title),!e.description&&t.description&&(e.description=t.description),!e.thumb&&t.artwork_url&&(e.thumb=t.artwork_url,e.thumbQuality&&(e.thumb=e.thumb.replace("large.jpg",e.thumbQuality))),e.favoritingsCount=parseInt(t.favoritings_count?t.favoritings_count:0,10),e.playbackCount=parseInt(t.playback_count?t.playback_count:0,10),e.hotness=e.favoritingsCount+e.playbackCount,"undefined"==typeof e.share&&t.permalink_url&&(e.share=t.permalink_url),Se.push(e)}}function x(t){Re.empty();var e,a=t.length;for(e=0;e<a;e++){var i=t[e],n=ba('<div class="hap-playlist-item"/>'),r=i.thumb;if(r){var o=new Image;o.className="hap-hidden",o.onload=function(){this.className="hap-visible"},o.src=r,0==e&&(re=r),ba('<span class="hap-playlist-thumb"></span>').append(o).appendTo(n)}r=ba('<span class="hap-playlist-info"></span>').appendTo(n),ba('<span class="hap-playlist-title">'+i.title+"</span>").appendTo(r),ba('<span class="hap-playlist-artist">'+i.artist+"</span>").appendTo(r),n.appendTo(Re)}ie||(ie=!0,R(Ue)),ne||(ne=!0,ba(Bt).trigger("historyEndLoad"))}function M(){var t,e,a=Oe.length,i=0;for(t=0;t<a;t++){fe&&i++;var n=Oe[t],r=n.type;if(ht){if(n instanceof ba&&n.hasClass("hap-playlist-item")){if(r=n,fe){o?o.after(r):ce?r.appendTo(V):V.children("div").eq(he).before(r);var o=r}else r.appendTo(V);var l=r.find(".hap-playlist-non-selected, .hap-playlist-selected")}else{if(n.origclasses||(n.origclasses="hap-playlist-item"),r=ba('<div class="'+n.origclasses+'"/>').attr("data-type",r),fe?(o?o.after(r):ce?r.appendTo(V):V.children("div").eq(he).before(r),o=r):r.appendTo(V),l=ba('<a class="hap-playlist-non-selected" href="#"/>').appendTo(r),-1!=ba.inArray("thumb",Rt)&&(e=n.thumb||n.thumbDefault)){var s=new Image;s.className="hap-hidden",s.onload=function(){this.className="hap-visible"},s.src=e,ba('<span class="hap-playlist-thumb"></span>').append(s).appendTo(l),r.attr("data-thumb",e)}-1!=ba.inArray("title",Rt)&&(e=X(n),ba('<span class="hap-playlist-title">'+e+"</span>").appendTo(l),r.attr("data-title",n.title)),(n.path||n.mp3)&&r.attr("data-mp3",n.path||n.mp3),n.hls&&r.attr("data-hls",n.hls),n.description&&r.attr("data-description",n.description),n.share&&r.attr("data-share",n.share),n.download&&r.attr("data-download",n.download),n.album&&r.attr("data-album",n.album),n.id3&&r.attr("data-id3",n.id3),n.start&&r.attr("data-start",n.start),n.end&&r.attr("data-end",n.end),n.playbackRate&&r.attr("data-playback-rate",n.playbackRate),n.link&&(r.attr("data-link",n.link),n.target&&r.attr("data-target",n.target)),Ot&&n.link&&(e=ba('<a class="hap-link" href="'+n.link+'" target="'+n.target+'"><i class="fa fa-link"></i></a>'),l.after(e)),Yt&&Dt&&n.download&&(e=ba('<a class="hap-download" href="'+n.download+'" download title="Download"><i class="fa fa-download"></i></a>'),l.after(e)),n.content&&(r.append(n.content),delete n.content)}n.thumb&&!n.artwork&&(n.artwork=[{src:n.thumb}]),l.on("click",p),ft||l.on("mouseenter",c).on("mouseleave",h)}}ye=V,S(),console.log("playlistLength = ",je),fe?(t=$e.getCounter(),$e.setPlaylistItems(je,!1),he<=t&&(ce||$e.reSetCounter(t+i)),ge?(ge=!1,me&&!ft&&(wt=!0),$e.setCounter(he,!1)):me&&$e.setCounter(he,!1)):$e.setPlaylistItems(je),N(),ba(Bt).trigger("playlistEndLoad",{instance:Bt,instanceName:vt})}function S(){if(je=V.children(".hap-playlist-item").length,ht){var t,e,a,i,n=0;Fe=[],V.find(".hap-playlist-item").each(function(){e=ba(this).find(".hap-playlist-non-selected, .hap-playlist-selected"),(a=e.find(".hap-playlist-title")).length&&(t=a.html(),Fe.push(t),kt&&(i=HAPUtils.formatNumber(n)+jt,e.find(".hap-playlist-title-num").length?e.find(".hap-playlist-title-num").html(i):a.before(ba('<span class="hap-playlist-title-num">'+i+"</span>")))),n++})}}function U(){if(ht){var t,e,a=0;V.find(".hap-playlist-item").each(function(){t=ba(this).find(".hap-playlist-non-selected, .hap-playlist-selected"),e=HAPUtils.formatNumber(a)+jt,t.find(".hap-playlist-title-num").length?t.find(".hap-playlist-title-num").html(e):title_node.before(ba('<span class="hap-playlist-title-num">'+e+"</span>")),a++})}}function R(t){console.log("checkPlaylistScroll"),t.mCustomScrollbar({axis:"horizontal"==Et?"x":"y",theme:d.playlistScrollTheme,scrollInertia:0,mouseWheel:{normalizeDelta:!0,deltaFactor:50,preventDefault:!0},keyboard:{enable:!1},advanced:{autoExpandHorizontalScroll:!0},callbacks:{onOverflowYNone:function(){t.find(".mCSB_container").addClass("hap-mCSB_full")},onOverflowY:function(){t.find(".mCSB_container").removeClass("hap-mCSB_full")}}})}function N(){if(et.hide(),ct=!1,pt||(pt=!0,At&&!ue&&(R(Q),ue=!0),$(),z.css("opacity",1),o(Mt),d.autoOpenPopup&&!d.isPopup&&hapOpenPopup(Bt,d),ba(Bt).trigger("setupDone",{instance:Bt,instanceName:vt})),Tt&&!de&&(V.sortable({update:function(){if(be){var t=be.closest(".hap-playlist-item").index();$e.reSetCounter(t)}kt&&U()}}),de=!0),!ve&&!fe&&0<je){var t=d.activeItem;je-1<t&&(t=je-1),-1<t&&$e.setCounter(t,!1),ve=!0}fe=!1}function L(){var e,a,i,n=0;Fe=[],V.find(".hap-playlist-item").each(function(){ba(this).find(".hap-playlist-non-selected").each(function(){var t=ba(this).on("click",p);ft||t.on("mouseenter",c).on("mouseleave",h),(a=t.find(".hap-playlist-title")).length&&(e=a.html(),Fe.push(e),kt&&(i=HAPUtils.formatNumber(n)+jt,t.find(".hap-playlist-title-num").length?t.find(".hap-playlist-title-num").html(i):a.before(ba('<span class="hap-playlist-title-num">'+i+"</span>"))))}),n++}),je=n,$e.setPlaylistItems(je),ye=V,pt||(pt=!0,At&&!ue&&(R(Q),ue=!0),o(Mt),z.css("opacity",1),d.autoOpenPopup&&!d.isPopup&&hapOpenPopup(Bt,d),ba(Bt).trigger("setupDone",{instance:Bt,instanceName:vt})),et.hide(),ct=!1,ba(Bt).trigger("playlistEndLoad",{instance:Bt,instanceName:vt});var t=d.activeItem;je-1<t&&(t=je-1),-1<t&&$e.setCounter(t,!1)}function _(){++oe==le?O():ae.artist.getInfo({artist:Le[oe].artist},{success:function(t){Ne||(t=""!=t.artist.image[3]["#text"].trim()?t.artist.image[3]["#text"].trim():Ae.thumbDefault,Le[oe]&&(Le[oe].thumb=t,_()))},error:function(){Ne||(Le[oe].thumb=Ae.thumbDefault,_())}})}function D(){Le=[],oe=-1;var t=Ce;";"==t.substring(t.length-1)&&(t=t.substring(0,t.length-1));var n=new XMLHttpRequest;n.open("GET","https://cors-anywhere.herokuapp.com/"+t+"played.html"),n.onload=function(){var t,e=n.responseText,a=e.indexOf("Song Title")+12;for((e=(e=e.substr(a,e.length)).split("</td><td>")).shift(),le=e.length,t=0;t<le;t++){a=e[t].indexOf("</"),e[t]=e[t].substr(0,a),e[t]=e[t].replace(/<\/?[^>]+(>|$)/g,"");var i=e[t].split(" - ");a=i[0].trim(),i=i[1]?i[1].trim():"",0==t&&(i=i.substr(0,i.length-12)),Le.push({title:i,artist:a})}Ne=!1,_()},n.onerror=function(){console.log("Radio history Error: ",n.status+" "+n.statusText),se&&clearInterval(se),se=setInterval(function(){D()},_e)},/^POST/i.test("GET")&&n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.send()}function O(){var t=Le.shift();if(it.find("img").attr("src")!=t.thumb){var e=new Image;e.className="hap-hidden",e.onload=function(){this.className="hap-visible"},it.empty(),it[0].appendChild(e),e.src=t.thumb}nt.html(t.title),rt.html(t.artist),d.generateHistory?re!=Le[0].thumb&&x(Le):ne||(ne=!0,ba(Bt).trigger("historyEndLoad")),se&&clearInterval(se),se=setInterval(function(){D()},_e)}function q(){var t;if(Qt||(Vt=ba(document.createElement("audio")).attr("preload",bt),Jt=Vt[0],Qt=!0),Ce=t=(xe||Jt.canPlayType("application/vnd.apple.mpegurl"))&&Ae.hls?Ae.hls:He&&Ae.mp3?Ae.mp3:Ie&&Ae.wav?Ae.wav:Ae.path,Jt.src=t,Vt.on("ended",function(){F()}).on("canplay",function(){}).on("canplaythrough",function(){}).on("loadedmetadata",function(){Ae.playbackRate&&(Jt.playbackRate=Number(Ae.playbackRate)),d.resumeTime?(Jt.currentTime=d.resumeTime,delete d.resumeTime):Ae.start&&(Jt.currentTime=Ae.start)}).on("play",function(){if(we||(we=!0,Je=Ze.width(),Ee&&cancelAnimationFrame(Ee),Ee=requestAnimationFrame(j),ba(Bt).trigger("soundStart",{instance:Bt,instanceName:vt,counter:$e.getCounter()})),qt&&1<hap_mediaArr.length){var t,e=hap_mediaArr.length;for(t=0;t<e;t++)Bt!=hap_mediaArr[t].inst&&hap_mediaArr[t].inst.pauseMedia()}st.find("i").removeClass("fa-play").addClass("fa-pause"),ke=!0,ba(Bt).trigger("soundPlay",{instance:Bt,instanceName:vt,counter:$e.getCounter()})}).on("pause",function(){st.find("i").removeClass("fa-pause").addClass("fa-play"),ke=!1,ba(Bt).trigger("soundPause",{instance:Bt,instanceName:vt,counter:$e.getCounter()})}).on("error",function(){ba(Bt).trigger("soundError",{instance:Bt,instanceName:vt,counter:$e.getCounter()})}),xe&&"hls"==Pe){if("file:"==window.location.protocol)return alert("Playing HLS requires server connection!"),!1;va.attachMedia(Jt),wt&&Jt.play()}else wt&&(Jt.load(),Jt.play());Jt.volume=Mt,wt=!0,"radio"==Pe&&((HAPUtils.isEmpty(d.lastFmApiKey)||HAPUtils.isEmpty(d.lastFmApiSecret))&&alert("Last.fm API credentials missing!"),ee||(ee=new LastFMCache,ae=new LastFM({apiKey:d.lastFmApiKey,apiSecret:d.lastFmApiSecret,cache:ee})),D())}function j(){if(Jt){var t=Jt.currentTime,e=Jt.duration;if(HAPUtils.isNumber(t)&&HAPUtils.isNumber(e)){if(ot.html(HAPUtils.formatCurrentTime(t)),lt.html(HAPUtils.formatDuration(e)),"undefined"!=typeof Jt.buffered&&0!=Jt.buffered.length){try{var a=Jt.buffered.end(Jt.buffered.length-1)}catch(n){}if(!isNaN(a))var i=a/e}Ye?ze.drawSeekbar(i,t,e):(ea.width(t/e*Je),i&&ta.width(i*Je)),Ae.end&&t>=Ae.end&&F()}}Ee=requestAnimationFrame(j)}function F(){ba(Bt).trigger("soundEnd",{instance:Bt,instanceName:vt,counter:$e.getCounter()});var t=Ae.start||0;"next"==Ut?Bt.nextMedia():"loop"==Ut?(Jt.currentTime=t,Jt.play()):"rewind"==Ut?(Jt.currentTime=t,Jt.pause()):"stop"==Ut&&Jt.pause()}function B(){Ee&&cancelAnimationFrame(Ee),se&&clearInterval(se),se=null,xe&&"hls"==Pe&&va.detachMedia(),Jt&&(Jt.pause(),Jt.src=""),Vt&&Vt.off("ended canplay canplaythrough loadedmetadata pause play error"),ot.html("0:00"),lt.html("0:00"),it.empty(),nt.html(""),rt.html(""),ea.width(0),ta.width(0),Pe=null,me=we=ke=!1,st.find("i").removeClass("fa-pause").addClass("fa-play")}function W(){Pe&&(B(),g()),ht&&(Tt&&(V.sortable("destroy"),de=!1),V.find(".hap-playlist-item").remove()),Re.empty(),yt=ye=re=null,ve=ge=fe=!(Ne=!(ne=!1)),je=0,De=-1,Oe=[],qe=[],Fe=[],$e.reSetCounter(),Be.val(We),Te=!1,tt.find("i").removeClass("fa-sort-alpha-up").addClass("fa-sort-alpha-down")}function $(){Je=Ze.width()}function X(t){if("undefined"==typeof t.artist||HAPUtils.isEmpty(t.artist)||"undefined"==typeof t.title||HAPUtils.isEmpty(t.title))"undefined"!=typeof t.artist||"undefined"==typeof t.title||HAPUtils.isEmpty(t.title)?"undefined"==typeof t.artist||HAPUtils.isEmpty(t.artist)||"undefined"!=typeof t.title||(e=t.artist):e=t.title;else var e=t.artist+Ft+t.title;return e}function Y(){if(it.length){var t=new Image;t.className="hap-hidden",t.onload=function(){this.className="hap-visible"},it.empty(),it[0].appendChild(t),t.src=Ae.thumb||Ae.thumbDefault}Ae.title&&nt.html(Ae.title),Ae.artist&&rt.html(Ae.artist)}var z=ba(this),G=ba(d.playlistList).hide(),K=z.find(".hap-playlist-holder"),Q=z.find(".hap-playlist-inner"),V=z.find(".hap-playlist-content"),J=z.find(".hap-playlist-filter-msg"),Z=z.find(".hap-share-holder"),tt=z.find(".hap-sort-alpha"),et=z.find(".hap-preloader"),at=z.find(".hap-popup-toggle");z.find(".hap-player-holder");var it=z.find(".hap-player-thumb"),nt=z.find(".hap-player-title"),rt=z.find(".hap-player-artist"),ot=z.find(".hap-media-time-current"),lt=z.find(".hap-media-time-total"),st=z.find(".hap-playback-toggle"),dt=z.find(".hap-loop-toggle"),ut=z.find(".hap-random-toggle");et=z.find(".hap-preloader");var pt,ct,ht=K.length,ft=HAPUtils.isMobile(),mt=HAPUtils.hasLocalStorage(),gt=d.sourcePath,vt=d.instanceName,yt=d.activePlaylist,bt=d.preload,wt=d.autoPlay,Pt=d.loopingOn,Ct=d.randomPlay,kt=d.useNumbersInPlaylist,At=d.usePlaylistScroll,Et=d.playlistScrollOrientation,Tt=!ft&&d.sortableTracks,Ht=d.facebookAppId,It=d.soundCloudAppId,xt=d.gDriveAppId,Mt=d.volume,St=d.useKeyboardNavigationForPlayback,Ut=d.mediaEndAction,Rt=d.playlistItemContent.split(","),Nt=d.useContinousPlayback&&mt,Lt=d.continousKey,_t=d.useMediaSession&&"mediaSession"in navigator,Dt=d.createDownloadIconsInPlaylist,Ot=d.createLinkIconsInPlaylist,qt=d.togglePlaybackOnMultipleInstances,jt=d.numberTitleSeparator||".  ",Ft=d.artistTitleSeparator||" - ",Bt=this;ba("body");var Wt,$t=ba(window),Xt=ba(document),Yt=HAPUtils.hasDownloadSupport(),zt=HAPUtils.isIOS();HAPUtils.isAndroid();var Gt,Kt,Qt,Vt,Jt,Zt,te,ee,ae,ie,ne,re,oe,le,se,de,ue,pe,ce,he,fe,me,ge,ve,ye,be,we,Pe,Ce,ke,Ae,Ee,Te,He=HAPUtils.canPlayMp3(),Ie=HAPUtils.canPlayWav(),xe=window.Hls&&Hls.isSupported(),Me=gt+"includes/ba-simple-proxy.php",Se=[],Ue=z.find(".hap-history-inner"),Re=z.find(".hap-history-content"),Ne=!0,Le=[],_e=d.lastPlayedInterval,De=-1,Oe=[],qe=[],je=0,Fe=[];"undefined"==typeof window.hap_mediaArr&&(window.hap_mediaArr=[]),window.hap_mediaArr.push({inst:Bt,id:vt}),ft&&(wt=!1),Pt&&dt.find("i").removeClass("hap-icon-color").addClass("hap-icon-rollover-color"),Ct&&ut.find("i").removeClass("hap-icon-color").addClass("hap-icon-rollover-color"),z.find(".hap-select").change(function(){Bt.loadPlaylist(ba(this).val())});var Be=z.find(".hap-search-filter"),We=Be.val();Be.on("focus",function(){ba(this).val()==We&&ba(this).val("")}).on("blur",function(){HAPUtils.isEmpty(ba(this).val())&&ba(this).val(We)}).on("keyup.apfilter",function(){if(0==Fe.length)return!1;var t=ba(this).val();t=Fe.filter(/./.test.bind(new RegExp(t,"i")));var e,a=0;for(e=0;e<je;e++){var i=V.children(".hap-playlist-item").eq(e).find(".hap-playlist-title").html();-1<ba.inArray(i,t)?V.children(".hap-playlist-item").eq(e).show():(V.children(".hap-playlist-item").eq(e).hide(),a++)}a==je?J.show():J.hide()}),HAPUtils.isEmpty(Ht)||"file:"==window.location.protocol?console.log("facebookAppId has not been set in settings!"):t(Ht);var $e=new HAPPlaylistManager(d);ba($e).on("HAPPlaylistManager.COUNTER_READY",function(){Pe&&B();var t=$e.getCounter(),e=V.children(".hap-playlist-item").eq(t);Ae=b(e),Pe=Ae.type,be&&g(),(be=V.children(".hap-playlist-item").eq(t).find(".hap-playlist-non-selected, .hap-playlist-selected")).length&&(be.removeClass("hap-playlist-non-selected").addClass("hap-playlist-selected"),At&&0<je&&(pe||("horizontal"==Et?Q.mCustomScrollbar("scrollTo",parseInt(be.closest(".hap-playlist-item").position().left),{scrollInertia:500}):Q.mCustomScrollbar("scrollTo",parseInt(be.closest(".hap-playlist-item").position().top),{scrollInertia:500})),pe=!1),ba(Bt).trigger("playlistItemDisabled",{instance:Bt,instanceName:vt,item:be})),Y(),_t&&(navigator.mediaSession.metadata=new MediaMetadata({title:Ae.title,artist:Ae.artist||"",album:Ae.album||"",artwork:Ae.artwork})),q(),ba(Bt).trigger("soundRequest",{instance:Bt,instanceName:vt,
counter:t})}),Nt&&(window.attachEvent||window.addEventListener)(zt?"pagehide":"beforeunload",function(t){if(window.event&&(window.event.cancelBubble=!0),!pt||!Pe)return!1;t={volume:Mt,activeItem:$e.getCounter(),resumeTime:Bt.getCurrentTime(),autoPlay:ke},localStorage.setItem(Lt,JSON.stringify(t))}),_t&&(navigator.mediaSession.setActionHandler("play",function(){Bt.playMedia()}),navigator.mediaSession.setActionHandler("pause",function(){Bt.pauseMedia()}),navigator.mediaSession.setActionHandler("previoustrack",function(){Bt.previousMedia()}),navigator.mediaSession.setActionHandler("nexttrack",function(){Bt.nextMedia()}),navigator.mediaSession.setActionHandler("seekbackward",function(){Bt.seekBackward()}),navigator.mediaSession.setActionHandler("seekforward",function(){Bt.seekForward()}));var Xe=z.find(".hap-tooltip");ft||z.find("[data-tooltip]").on("mouseenter",function(t){var e=ba(this);t=z[0].getBoundingClientRect();var a=e[0].getBoundingClientRect();Xe.find("p").text(e.attr("data-tooltip"));var i=parseInt(a.top-t.top-Xe.outerHeight());(e=parseInt(a.left-t.left-Xe.outerWidth()/2+e.outerWidth()/2))+Xe.outerWidth()>z.width()?e=z.width()-Xe.outerWidth():e<0&&(e=0),i+t.top<0&&(i=parseInt(a.top-t.top+Xe.outerHeight()+15)),Xe.css({left:e+"px",top:i+"px"}).show()}).on("mouseleave",function(){Xe.hide()});var Ye=z.find(".hap-circle-player").length;if(Ye&&HAPUtils.hasCanvas())var ze=new HAPCirclePlayer({settings:d,parent:z});if("ontouchstart"in window)var Ge="touchstart.ap mousedown.ap",Ke="touchmove.ap mousemove.ap",Qe="touchend.ap mouseup.ap";else window.PointerEvent?(Ge="pointerdown.ap",Ke="pointermove.ap",Qe="pointerup.ap"):(Ge="mousedown.ap",Ke="mousemove.ap",Qe="mouseup.ap");var Ve,Je,Ze=z.find(".hap-progress-bg"),ta=z.find(".hap-load-level"),ea=z.find(".hap-progress-level"),aa=Ye?z.find(".hap-progress-canvas"):z.find(".hap-seekbar");if(aa.on(Ge,function(t){return e(t),!1}),!ft){var ia=function(){we&&(aa.off(Ke,i).off("mouseout",ia),Xt.off("mouseout",ia),Xe.hide())};aa.on("mouseover",function(){we&&(aa.on(Ke,i).on("mouseout",ia),Xt.on("mouseout",ia))})}var na,ra=.5,oa=z.find(".hap-volume-toggle"),la=z.find(".hap-volume-seekbar"),sa=z.find(".hap-volume-bg"),da=z.find(".hap-volume-level"),ua=null!=la.attr("data-is-vertical"),pa=ua?sa.height():sa.width();if(Mt<0?Mt=0:1<Mt&&(Mt=1),0!=Mt&&(ra=Mt),la.on(Ge,function(t){return n(t),!1}),!ft){var ca=function(){la.off(Ke,l).off("mouseout",ca),Xt.off("mouseout",ca),Xe.hide()};la.on("mouseover",function(){la.on(Ke,l).on("mouseout",ca),Xt.on("mouseout",ca)})}d.disableRightClickOverPlayer&&z.on("contextmenu",function(){return!1}),St&&Xt.on("keyup.apnav",function(t){if(!pt)return!1;var e=t.keyCode;if(t=ba(t.target),37==e)Bt.previousMedia();else if(39==e)Bt.nextMedia();else if(32==e){if(t.hasClass("hap-search-filter"))return!1;Bt.togglePlayback()}else if(77==e){if(t.hasClass("hap-search-filter"))return!1;u()}});var ha,fa=[z.find(".hap-next-toggle"),z.find(".hap-prev-toggle"),z.find(".hap-share-toggle"),z.find(".hap-playlist-toggle"),z.find(".hap-share-item"),oa,at,tt,st,dt,ut],ma=fa.length;for(ha=0;ha<ma;ha++){var ga=ba(fa[ha]).css("cursor","pointer").on("click",s);ft||ga.on("mouseenter",f).on("mouseleave",m)}if(xe){var va=new Hls;va.on(Hls.Events.MEDIA_ATTACHED,function(){va.loadSource(Ce)}),va.on(Hls.Events.ERROR,function(t,e){if(e.fatal)switch(e.type){case Hls.ErrorTypes.NETWORK_ERROR:console.log("fatal network error encountered, try to recover"),va.startLoad();break;case Hls.ErrorTypes.MEDIA_ERROR:console.log("fatal media error encountered, try to recover"),va.recoverMediaError();break;default:va.destroy()}})}if($t.on("resize",function(){if(!pt)return!1;Wt&&clearTimeout(Wt),Wt=setTimeout($,150)}),this.playMedia=function(){if(!pt||!Pe||ke)return!1;Jt&&Jt.play()},this.pauseMedia=function(){if(!pt||!Pe||!ke)return!1;Jt&&Jt.pause()},this.checkMedia=function(t){if(!pt||!Pe)return!1;t=t.toLowerCase(),ke&&"pause"==t&&Jt&&Jt.pause()},this.togglePlayback=function(){if(!pt||!Pe)return!1;Jt&&(Jt.paused?Jt.play():Jt.pause())},this.nextMedia=function(){if(!pt)return!1;0!=je&&$e.advanceHandler(1,!0)},this.previousMedia=function(){if(!pt)return!1;0!=je&&$e.advanceHandler(-1,!0)},this.loadMedia=function(t){if(!pt||ct)return!1;if(0!=je){if(void 0===t)return alert("loadMedia method requires either a track number or a track title to load. LoadMedia failed."),!1;if("string"==typeof t){var e;if(V.find(".hap-playlist-item").each(function(){if(ba(this).find(".hap-playlist-title").html()==t)return t=ba(this).index(),!(e=!0)}),!e)return alert('Track with title "'+t+'" doesnt exist. LoadMedia failed.'),!1}else{if("number"!=typeof t)return alert("loadMedia method requires either a track number or a track title to load. LoadMedia failed."),!1;if(t<0||je-1<t)return alert('Invalid track number. Track number  "'+t+'" doesnt exist. LoadMedia failed.'),!1}$e.processPlaylistRequest(t)}},this.loadPlaylist=function(t){return!(!pt||ct)&&(void 0===t||HAPUtils.isEmpty(t)?(alert("loadPlaylist method requires id parameter. loadPlaylist failed."),!1):yt!=t&&void v(t))},this.addTrack=function(t,e,a,i){if(!pt||ct)return!1;if(void 0===t)return alert("addTrack method requires format parameter. AddTrack failed."),!1;if(void 0===e)return alert("addTrack method requires track parameter. AddTrack failed."),!1;me=!1,void 0!==a&&(me=a);var n=!(a=1);if("string"!=typeof e&&"[object Object]"!==Object.prototype.toString.call(e)){if("[object Array]"!==Object.prototype.toString.call(e))return alert("addTrack method requires track as string, object or array parameter. AddTrack failed."),!1;a=e.length,n=!0}if(he=i,fe=!(ce=!1),ye)if(void 0!==he){if(he<0||je<he)return alert('Invalid position to insert track to. Position number "'+i+'" doesnt exist. AddTrack failed.'),!1;he==je&&(ce=!0)}else ce=!0,he=je;else{if(void 0!==he){if(0!=he)return alert('Invalid position to insert track to. Position number "'+i+'" doesnt exist. AddTrack failed.'),!1}else he=0;ce=!0}for(ct=!0,et.show(),De=-1,Oe=[],qe=[],i=0;i<a;i++){var r=n?e[i]:e;r="html"==t?ba(ba.parseHTML(r)):r,qe.push(r)}je=qe.length,ge=!1,ye||(ge=!0),ye=V,y()},this.inputAudio=function(t){return!(!pt||ct)&&(void 0===t?(alert("inputAudio method requires data parameter. inputAudio failed."),!1):(g(),$e.reSetCounter(),Ae=t,Pe="audio",Y(),wt=!0,void q()))},this.removeTrack=function(t){if(!pt||ct)return!1;if(0!=je){if(void 0===t)return alert("removeTrack method requires id parameter. removeTrack failed."),!1;if("string"==typeof t){var e=!1;if(V.find(".hap-playlist-item").each(function(){if(ba(this).find(".hap-playlist-title").html()==t)return a=ba(this),t=a.index(),!(e=!0)}),!e)return alert('Track with title "'+t+'" doesnt exist. RemoveTrack failed.'),!1}else{if("number"!=typeof t)return alert("removeTrack method requires either a id number or a track title to remove. removeTrack failed."),!1;if((t=parseInt(t,10))<0||je-1<t)return alert('Invalid id number. Track number  "'+t+'" doesnt exist. RemoveTrack failed.'),!1;var a=V.find(".hap-playlist-item").eq(t)}if(a.remove(),S(),0<je){var i=$e.getCounter();t==i?(B(),$e.setPlaylistItems(je)):($e.setPlaylistItems(je,!1),t<i&&$e.reSetCounter($e.getCounter()-1))}else W()}},this.sort=function(t,e){if(!pt)return!1;if(0!=je){if(void 0===t)return console.log("Sort method requires type parameter. Sort method failed."),!1;var a=t.toLowerCase();if("title"==a)e?(V.children(".hap-playlist-item").sort(function(t,e){return ba(e).find(".hap-playlist-title").html()>ba(t).find(".hap-playlist-title").html()?1:-1}).appendTo(V),Te=!1):(V.children(".hap-playlist-item").sort(function(t,e){return ba(e).find(".hap-playlist-title").html()<ba(t).find(".hap-playlist-title").html()?1:-1}).appendTo(V),Te=!0);else{if("random"!=a)return console.log("Sort method requires type parameter. Sort method failed."),!1;for(a=V.children();a.length;)V.append(a.splice(Math.floor(Math.random()*a.length),1));Te=!1}Te?tt.find("i").removeClass("fa-sort-alpha-up").addClass("fa-sort-alpha-down"):tt.find("i").removeClass("fa-sort-alpha-down").addClass("fa-sort-alpha-up"),be&&(a=be.closest(".hap-playlist-item").index(),$e.reSetCounter(a)),kt&&U()}},this.destroyInstance=function(){$t&&$t.off(),la&&la.off(),aa&&aa.off(),B(),Q.mCustomScrollbar("destroy"),ue=!1,Tt&&(V.sortable("destroy"),de=!1)},this.destroyMedia=function(){if(!pt)return!1;pt&&Pe&&(be&&g(),B(),$e.reSetCounter())},this.destroyPlaylist=function(){if(!pt)return!1;W()},this.setPlaybackRate=function(t){if(!pt||!Pe)return!1;Jt&&(Jt.playbackRate=Number(t))},this.toggleRandom=function(t){if(!pt||void 0===$e)return!1;Ct=void 0!==t?t:!Ct,$e.setRandom(Ct),Ct?ut.find("i").removeClass("hap-icon-color").addClass("hap-icon-rollover-color"):ut.find("i").removeClass("hap-icon-rollover-color").addClass("hap-icon-color")},this.toggleLoop=function(t){if(!pt||void 0===$e)return!1;Pt=void 0!==t?t:!Pt,$e.setLooping(Pt),Pt?dt.find("i").removeClass("hap-icon-color").addClass("hap-icon-rollover-color"):dt.find("i").removeClass("hap-icon-rollover-color").addClass("hap-icon-color")},this.getVolume=function(){return Mt},this.getVolumeSize=function(){return!!pt&&pa},this.getVolumeOrientation=function(){return!!pt&&ua},this.setVolume=function(t){if(!pt)return!1;t<0?t=0:1<t&&(t=1),o(t)},this.toggleMute=function(){if(!pt)return!1;u()},this.seek=function(t){if(!pt||!Pe)return!1;try{Jt.currentTime=t}catch(e){console.log(e)}},this.seekBackward=function(){if(!pt||!Pe)return!1;if(Jt)try{Jt.currentTime=Math.max(Jt.currentTime-10,0)}catch(t){console.log(t)}},this.seekForward=function(){if(!pt||!Pe)return!1;if(Jt)try{Jt.currentTime=Math.min(Jt.currentTime+10,Jt.duration)}catch(t){console.log(t)}},this.getCurrentTime=function(){if(!pt||!Pe)return!1;var t=0;return Jt&&(t=Jt.currentTime),t},this.getDuration=function(){if(!pt||!Pe)return!1;if(Jt)var t=Jt.duration;return t},this.destroyPlaylistScroll=function(){if(!pt)return!1;Q.mCustomScrollbar("destroy"),ue=!1},this.getPlaylistList=function(){return!!pt&&G},this.getSetupDone=function(){return pt},this.getMediaPlaying=function(){return!!pt&&ke},this.getCounter=function(){return!!pt&&(void 0!==$e?$e.getCounter():-1)},this.getPlaylistLength=function(){return!!pt&&(HAPUtils.isNumber(je)?je:0)},this.getSettings=function(){return d},this.getCurrMediaData=function(){return!!pt&&Ae},this.getWrapper=function(){return z},this.getActivePlaylistItem=function(){return be},mt&&localStorage.getItem(Lt)){var ya=JSON.parse(localStorage.getItem(Lt));d.resumeTime=ya.resumeTime,Mt=ya.volume,wt=ya.autoPlay,d.activeItem=ya.activeItem,localStorage.removeItem(Lt)}return d.activePlaylist&&!HAPUtils.isEmpty(d.activePlaylist)?v(d.activePlaylist):L(),this}}(jQuery),function(a){var t=function(){};t.isEmpty=function(t){return 0==t.replace(/^\s+|\s+$/g,"").length},t.isNumber=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},t.isMobile=function(){return/Android|webOS|iPhone|iPad|iPod|sony|BlackBerry/i.test(navigator.userAgent)},t.isIE=function(){var t=-1;if("Microsoft Internet Explorer"==navigator.appName){var e=navigator.userAgent,a=/MSIE ([0-9]{1,}[.0-9]{0,})/;null!=a.exec(e)&&(t=parseFloat(RegExp.$1))}else"Netscape"==navigator.appName&&(e=navigator.userAgent,null!=(a=/Trident\/.*rv:([0-9]{1,}[.0-9]{0,})/).exec(e)&&(t=parseFloat(RegExp.$1)));return-1!=t},t.isIOS=function(){return navigator.userAgent.match(/(iPad|iPhone|iPod)/g)},t.isAndroid=function(){return-1<navigator.userAgent.indexOf("Android")},t.hasDownloadSupport=function(){return"download"in document.createElement("a")},t.qualifyURL=function(t){var e=document.createElement("a");return e.href=t,e.href},t.relativePath=function(t){return/^(?:[a-z]+:)?\/\//i.test(t)},t.hasLocalStorage=function(){try{return"localStorage"in a&&null!==a.localStorage}catch(t){return!1}},t.randomiseArray=function(t){var e,a=[],i=[];for(e=0;e<t;e++)a[e]=e;for(e=0;e<t;e++){var n=Math.round(Math.random()*(a.length-1));i[e]=a[n],a.splice(n,1)}return i},t.sortArray=function(t,e){var a,i=t.length,n=[];for(a=0;a<i;a++)n[a]=t[e[a]];return n},t.keysrt=function(t,n,e){var r=1;return e&&(r=-1),t.sort(function(t,e){var a=t[n],i=e[n];return r*(a<i?-1:i<a?1:0)})},t.parseXML=function(t){if(a.ActiveXObject&&a.GetObject){var e=new ActiveXObject("Microsoft.XMLDOM");return e.loadXML(t),e}if(a.DOMParser)return(new DOMParser).parseFromString(t,"text/xml");throw Error("No XML parser available")},t.formatCurrentTime=function(t){t=Math.round(t);var e=Math.floor(t/60);return(10<=e?e:""+e)+":"+(10<=(t=Math.floor(t%60))?t:"0"+t)},t.formatDuration=function(t){t=Math.round(t);var e=Math.floor(t/60);return(10<=e?e:""+e)+":"+(10<=(t=Math.floor(t%60))?t:"0"+t)},t.formatNumber=function(t){return t<9?"0"+(t+1):t+1},t.nFormatter=function(t,e){var a,i=[{value:1e18,symbol:"E"},{value:1e15,symbol:"P"},{value:1e12,symbol:"T"},{value:1e9,symbol:"G"},{value:1e6,symbol:"M"},{value:1e3,symbol:"k"}],n=/\.0+$|(\.[0-9]*[1-9])0+$/;for(a=0;a<i.length;a++)if(t>=i[a].value)return(t/i[a].value).toFixed(e).replace(n,"$1")+i[a].symbol;return t.toFixed(e).replace(n,"$1")},t.canPlayMp3=function(){var t=document.createElement("audio");return!(!t.canPlayType||!t.canPlayType("audio/mpeg;").replace(/no/,""))},t.canPlayWav=function(){var t=document.createElement("audio");return!(!t.canPlayType||!t.canPlayType("audio/wav;").replace(/no/,""))},t.canPlayOgg=function(){var t=document.createElement("audio");return!(!t.canPlayType||!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/no/,""))},t.hasCanvas=function(){return!!document.createElement("canvas")},a.HAPUtils=t}(window),function(t,h){t.HAPPlaylistManager=function(t){function i(){p=HAPUtils.randomiseArray(n)}var n,a,e,r=this,o=t.loopingOn,l=t.randomPlay,s=!1,d=-1,u=!1,p=[],c=!1;this.setCounter=function(t,e){if(void 0===e&&(e=!0),d=e?d+parseInt(t,10):parseInt(t,10),isNaN(d))alert("HAPPlaylistManager message: No active media, counter = "+d);else if(s=!1,o){if(l)if(n-1<d){if(d=p[n-1],i(),p[0]==d){var a=p.splice(0,1);p.push(a)}d=0,h(r).trigger("HAPPlaylistManager.PLAYLIST_END_ALERT")}else d<0&&(d=p[0],i(),p[n-1]==d&&(a=p.splice(n-1,1),p.unshift(a)),d=n-1);else n-1<d?(d=0,h(r).trigger("HAPPlaylistManager.PLAYLIST_END_ALERT")):d<0&&(d=n-1);h(r).trigger("HAPPlaylistManager.COUNTER_READY")}else n-1<d?(d=n-1,s=!0):d<0&&(d=0),s?h(r).trigger("HAPPlaylistManager.PLAYLIST_END"):h(r).trigger("HAPPlaylistManager.COUNTER_READY")},this.getCounter=function(){return l?c?d:p[d]:d},this.advanceHandler=function(t){c=!1,u?(u=!1,n-1<e+t?(d=n-1,h(r).trigger("HAPPlaylistManager.COUNTER_READY")):e+t<0?(d=0,h(r).trigger("HAPPlaylistManager.COUNTER_READY")):r.setCounter(e+t,!1)):r.setCounter(t)},this.processPlaylistRequest=function(t){c=!1,l&&(c=!0,a=t,u||(e=d,u=!0)),r.setCounter(t,!1)},this.setPlaylistItems=function(t,e){void 0===e&&(e=!0),e&&(d=-1),n=t,l&&i()},this.reSetCounter=function(t){void 0===t?d=-1:(t=parseInt(t,10),n?(n-1<t?t=n-1:t<0&&(t=0),d=t):d=-1)},this.setRandom=function(t){if((l=t)&&i(),l){var e=p.length;for(t=0;t<e;t++)if(p[t]==d){if(0==t)break;t=p.splice(t,1),p.unshift(parseInt(t,10));break}d=0}else u?(d=a,u=!1):d=p[d]},this.setLooping=function(t){o=t},this.getPosition=function(t){return p.indexOf(t)}}}(window,jQuery);