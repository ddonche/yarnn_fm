
  <head>
    <title><%= @track.title %></title>

    <!-- Include Resource Stylesheets -->
		<link rel="stylesheet" type="text/css" href="../resources/css/foundation.min.css"/>

    <!-- Include font -->
    <link href="https://fonts.googleapis.com/css?family=Lato:400,400i" rel="stylesheet">

		<!-- Include Amplitude JS -->
		<%= javascript_include_tag 'amplitude', 'data-turbolinks-track': 'reload' %>


		<!--
			Include UX functions JS
			NOTE: These are for handling things outside of the scope of AmplitudeJS
		-->
		<script type="text/javascript" src="js/functions.js"></script>

		<!-- Include Style Sheet -->
		<%= stylesheet_link_tag    'styles', media: 'all', 'data-turbolinks-track': 'reload' %>
  </head>

<div id="album_show">
	<div id="banner" class="track_banner">
	  <%= render 'layouts/header' %>
	</div>
  <%= render 'shared/alert' %>
	<div id="breadcrumb">
		<%= link_to tracks_path do %>
		  Tracks
			<span>/</span>
			<% if @track.album_id? %>
			<%= link_to @track.album.title, album_path(@track.album_id) %>
			<span>/</span>
			<% end %>
			<%= @track.title %>
		<% end %>
	</div>
  <div class="wrapper_skinny">
    <div class="row">
      <div class="large-12 medium-12 small-12 columns">
        <div id="single-song-player">
          <img amplitude-song-info="cover_art_url" amplitude-main-song-info="true"/>
          <div class="bottom-container">
            <progress class="amplitude-song-played-progress" amplitude-main-song-played-progress="true" id="song-played-progress"></progress>

            <div class="time-container">
              <span class="current-time">
                <span class="amplitude-current-minutes" amplitude-main-current-minutes="true"></span>:<span class="amplitude-current-seconds" amplitude-main-current-seconds="true"></span>
              </span>
              <span class="duration">
                <span class="amplitude-duration-minutes" amplitude-main-duration-minutes="true"></span>:<span class="amplitude-duration-seconds" amplitude-main-duration-seconds="true"></span>
              </span>
            </div>

            <div class="control-container">
              <div class="amplitude-play-pause" amplitude-main-play-pause="true" id="play-pause"></div>
              <div class="meta-container">
                <span amplitude-song-info="name" amplitude-main-song-info="true" class="song-name"></span>
                <span amplitude-song-info="artist" amplitude-main-song-info="true"></span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <%= render 'buy_links' %>
    </div>
  </div>
    <script type="text/javascript">
      Amplitude.init({
        "bindings": {
          37: 'prev',
          39: 'next',
          32: 'play_pause'
        },
        "songs": [
          {
            "name": "<%= @track.title %><% if @track.explicit == "explicit" %>&nbsp;(explicit)<% end %>",
            "artist": "<%= @track.user.name %>",
            "album": "We Are to Answer",
            "url": "<%= @track.audio.url %>",
            "cover_art_url": "<%= @track.avatar.url %>"
          }
        ]
      });
      window.onkeydown = function(e) {
          return !(e.keyCode == 32);
      };
      /*
        Handles a click on the song played progress bar.
      */
      document.getElementById('song-played-progress').addEventListener('click', function( e ){
        var offset = this.getBoundingClientRect();
        var x = e.pageX - offset.left;
        Amplitude.setSongPlayedPercentage( ( parseFloat( x ) / parseFloat( this.offsetWidth) ) * 100 );
      });
    </script>